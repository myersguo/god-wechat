<view class="container">
  <!-- æ ‡é¢˜åŒºåŸŸ -->
  <view class="header">
    <text class="title">ğŸ”® AIæ™ºèƒ½ç®—å‘½ ğŸ”®</text>
    <text class="subtitle">è¾“å…¥å…«å­—ä¿¡æ¯ï¼Œè§£è¯»å‘½è¿ç„æœº</text>
  </view>

  <!-- ä¿¡æ¯è¾“å…¥åŒºåŸŸ -->
  <view class="input-section" wx:if="{{!fortuneResult && !isLoading}}">
    <!-- å§“åè¾“å…¥ -->
    <view class="input-group">
      <view class="input-label">
        <text class="label-icon">ğŸ‘¤</text>
        <text class="label-text">å§“å</text>
      </view>
      <input 
        class="input-field input-field-title" 
        placeholder="è¯·è¾“å…¥å§“å"
        value="{{userInfo.name}}"
        bindinput="onNameInput"
      />
    </view>

    <!-- æ€§åˆ«é€‰æ‹© -->
    <view class="input-group">
      <view class="input-label">
        <text class="label-icon">âš§</text>
        <text class="label-text">æ€§åˆ«</text>
      </view>
      <view class="gender-selector">
        <view 
          class="gender-option {{userInfo.gender === 'male' ? 'selected' : ''}}"
          bindtap="selectGender"
          data-gender="male"
        >
          <text>ç”·</text>
        </view>
        <view 
          class="gender-option {{userInfo.gender === 'female' ? 'selected' : ''}}"
          bindtap="selectGender"
          data-gender="female"
        >
          <text>å¥³</text>
        </view>
      </view>
    </view>

    <!-- å‡ºç”Ÿå¹´æœˆæ—¥ -->
    <view class="input-group">
      <view class="input-label">
        <text class="label-icon">ğŸ“…</text>
        <text class="label-text">å‡ºç”Ÿå¹´æœˆæ—¥</text>
      </view>
      <picker 
        mode="date"
        value="{{userInfo.birthDate}}"
        start="1900-01-01"
        end="2025-12-31"
        bindchange="onDateChange"
        class="date-picker"
      >
        <view class="picker-display">
          {{userInfo.birthDate || 'è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ'}}
        </view>
      </picker>
    </view>

    <!-- å‡ºç”Ÿæ—¶é—´ï¼ˆå¯é€‰ï¼‰ -->
    <view class="input-group">
      <view class="input-label">
        <text class="label-icon">ğŸ•</text>
        <text class="label-text">å‡ºç”Ÿæ—¶é—´ï¼ˆå¯é€‰ï¼‰</text>
      </view>
      <picker 
        mode="time"
        value="{{userInfo.birthTime}}"
        bindchange="onTimeChange"
        class="time-picker"
      >
        <view class="picker-display">
          {{userInfo.birthTime || 'è¯·é€‰æ‹©å‡ºç”Ÿæ—¶é—´'}}
        </view>
      </picker>
    </view>

    <!-- ç®—å‘½æŒ‰é’® -->
    <view class="calculate-container">
    <button 
        class="calculate-btn" 
        bindtap="startFortuneTelling"
        disabled="{{!userInfo.name || !userInfo.birthDate}}"
    >
        å¼€å§‹ç®—å‘½
    </button>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{isLoading}}">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <text class="loading-text">ğŸ”® æ­£åœ¨ä¸ºæ‚¨ç®—å‘½...</text>
      <text class="loading-desc">åˆ†æå…«å­—å‘½ç†ï¼Œè¯·ç¨å€™</text>
    </view>
  </view>

  <!-- ç®—å‘½ç»“æœæ˜¾ç¤º -->
  <view class="result-container" wx:if="{{fortuneResult && !isLoading}}">
    <view class="result-card">
      <!-- åŸºæœ¬ä¿¡æ¯ -->
      <view class="basic-info">
        <view class="info-header">
          <text class="info-icon">ğŸ“‹</text>
          <text class="info-title">åŸºæœ¬ä¿¡æ¯</text>
        </view>
        <view class="info-content">
          <text class="info-item">å§“åï¼š{{fortuneResult.name}}</text>
          <text class="info-item">æ€§åˆ«ï¼š{{fortuneResult.gender === 'male' ? 'ç”·' : 'å¥³'}}</text>
          <text class="info-item">å‡ºç”Ÿæ—¥æœŸï¼š{{fortuneResult.birthDate}}</text>
          <text class="info-item" wx:if="{{fortuneResult.birthTime}}">å‡ºç”Ÿæ—¶é—´ï¼š{{fortuneResult.birthTime}}</text>
        </view>
      </view>

      <!-- å‘½ç†åŸºç¡€ -->
      <view class="fortune-basics">
        <view class="basics-header">
          <text class="basics-icon">ğŸ²</text>
          <text class="basics-title">å‘½ç†åŸºç¡€</text>
        </view>
        <view class="basics-grid">
          <view class="basic-item">
            <text class="basic-label">ç”Ÿè‚–</text>
            <text class="basic-value">{{fortuneResult.zodiac}}</text>
          </view>
          <view class="basic-item">
            <text class="basic-label">æ˜Ÿåº§</text>
            <text class="basic-value">{{fortuneResult.constellation}}</text>
          </view>
          <view class="basic-item">
            <text class="basic-label">äº”è¡Œ</text>
            <text class="basic-value">{{fortuneResult.fiveElements}}</text>
          </view>
        </view>
      </view>

      <!-- æ€§æ ¼ç‰¹ç‚¹ -->
      <view class="personality-section">
        <view class="section-header">
          <text class="section-icon">ğŸ­</text>
          <text class="section-title">æ€§æ ¼ç‰¹ç‚¹</text>
        </view>
        <text class="section-content">{{fortuneResult.personality}}</text>
      </view>

      <!-- ç»¼åˆè¿åŠ¿ -->
      <view class="overall-fortune">
        <view class="section-header">
          <text class="section-icon">â­</text>
          <text class="section-title">ç»¼åˆè¿åŠ¿</text>
        </view>
        <text class="section-content">{{fortuneResult.overallFortune}}</text>
      </view>

      <!-- å„é¡¹è¿åŠ¿ -->
      <view class="detailed-fortune">
        <!-- äº‹ä¸šè¿åŠ¿ -->
        <view class="fortune-item">
          <view class="fortune-header">
            <text class="fortune-icon">ğŸ’¼</text>
            <text class="fortune-title">äº‹ä¸šè¿åŠ¿</text>
          </view>
          <text class="fortune-content">{{fortuneResult.careerFortune}}</text>
        </view>

        <!-- æ„Ÿæƒ…è¿åŠ¿ -->
        <view class="fortune-item">
          <view class="fortune-header">
            <text class="fortune-icon">ğŸ’•</text>
            <text class="fortune-title">æ„Ÿæƒ…è¿åŠ¿</text>
          </view>
          <text class="fortune-content">{{fortuneResult.loveFortune}}</text>
        </view>

        <!-- å¥åº·è¿åŠ¿ -->
        <view class="fortune-item">
          <view class="fortune-header">
            <text class="fortune-icon">ğŸ€</text>
            <text class="fortune-title">å¥åº·è¿åŠ¿</text>
          </view>
          <text class="fortune-content">{{fortuneResult.healthFortune}}</text>
        </view>
      </view>

      <!-- å¹¸è¿å…ƒç´  -->
      <view class="lucky-elements">
        <view class="section-header">
          <text class="section-icon">ğŸŒŸ</text>
          <text class="section-title">å¹¸è¿å…ƒç´ </text>
        </view>
        <text class="section-content">{{fortuneResult.luckyElements}}</text>
      </view>

      <!-- å¼€è¿å»ºè®® -->
      <view class="advice-section">
        <view class="section-header">
          <text class="section-icon">ğŸ’¡</text>
          <text class="section-title">å¼€è¿å»ºè®®</text>
        </view>
        <text class="section-content">{{fortuneResult.advice}}</text>
      </view>
    </view>
  </view>

  <!-- é‡æ–°ç®—å‘½æŒ‰é’® -->
  <view class="retry-container" wx:if="{{fortuneResult && !isLoading}}">
    <button class="retry-btn" bindtap="resetFortune">é‡æ–°ç®—å‘½</button>
  </view>
</view>
